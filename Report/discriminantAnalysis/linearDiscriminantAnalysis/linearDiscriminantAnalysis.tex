\section{Linear Discriminant Analysis}

\subsection{Theory}
bla bla

\subsection{Results}
In lab 4.6.3 We use Linear Discriminant Analysis. As we did in lab XXXX we split the data into before and after 2015 and then make training and testing data. Now that we have that out of the way it's time to import the Linear Discriminant Analysis from scikit-learn.
\begin{lstlisting}[language=Python]
from sklearn.discriminant_analysis import LinearDiscriminantAnalysis as LDA
\end{lstlisting}

Now the training process can begin.

\begin{lstlisting}[language=Python]
sklearn_lda = LDA(n_components=2) #creating a LDA object

lda = sklearn_lda.fit(X_train.iloc[:,1:3], y_train.iloc[:,1]) #learning the projection matrix

X_lda = lda.transform(X_train.iloc[:,1:3]) #using the model to project X. Project data to maximize class separation.

X_labels = lda.predict(X_train.iloc[:,1:3]) #gives you the predicted label for each sample

X_prob = lda.predict_proba(X_train.iloc[:,1:3]) #the probability of each sample to belong to each class
\end{lstlisting}

Now that the model have been fitted we will look at the coefficients of the model for Lag1 and Lag2.

\begin{lstlisting}[language=Python]
lda.coef_
array([[-0.05544078, -0.0443452 ]])
\end{lstlisting}

Now we will look at the priors. Therefor we can see that. $$ \hat{ \pi }_1 = -0.05544078  \hat{ \pi }_2 = -0.0443452 $$ 
\begin{lstlisting}[language=Python]
lda.priors_
array([ 0.49198397,  0.50801603])
\end{lstlisting}

Testing step. Now we will test out model using the data.
\begin{lstlisting}[language=Python]
X_test_labels=lda.predict(X_test.iloc[:,1:3])
X_test_prob = lda.predict_proba(X_test.iloc[:,1:3])
\end{lstlisting}

To Get the accuracy of the test set. We use the following command.

\begin{lstlisting}[language=Python]
np.mean(y_test.iloc[:,1]==X_test_labels)
0.55952380952380953
\end{lstlisting}

Let's change the threshod a bit to see whether we can improve the accuracy. The 2nd column of X_test_prob is the probability belongs to UP group. The default value is 0.5, let us first check that.

\begin{lstlisting}[language=Python]
threshold = 0.5 
np.mean(y_test.iloc[:,1]==(X_test_prob[:,1]>=threshold))
0.55952380952380953
\end{lstlisting}

